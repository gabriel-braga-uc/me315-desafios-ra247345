---
title: "desafio05-247345"
author: "Gabriel Ozélo Braga"
date: "2025-09-11"
output: html_document
---
# RA: 247345
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#install.packages("RSQLite")
library(RSQLite)
db = dbConnect(SQLite(), "disco.db")
dbListTables(db)
dbListFields(db, "albums")
album_db = dbGetQuery(db,
'SELECT * FROM albums')
#head(album_db)
```

# Desafio .1
### (foi arrumado o SELECT)
## Selecione as colunas trackid, name, composer e unitprice. Ordene o objeto resultante por unitprice.
```{r}
sql = 'SELECT trackid, name, composer, unitprice FROM tracks ORDER BY unitprice'
res = dbGetQuery(db, sql)
head(res)
```
## Quais são as cidades de todos os clientes, ordenadas por nome de cidade?
```{r}
sql = 'SELECT city FROM customers ORDER BY city'
ex3a = dbGetQuery(db, sql)
head(ex3a)
```
# Nota: 
### Não sei qual está certo esse ou o anterior pois os enunciados são identicos, mas a diferença é que neste abaixo não se repetem as cidades.
## Quais são as cidades de todos os clientes, ordenadas por nome de cidade?
```{r}
sql = 'SELECT DISTINCT city FROM customers ORDER BY city'
ex3b = dbGetQuery(db, sql)
head(ex3b)

```

## Quais são todas as músicas do álbum 1?
```{r}
dbGetQuery(db,
'SELECT name, albumid FROM tracks WHERE albumid=1')
```
## Limitando-se a 5 registros, após ordenação por nome, quais são os nomes, ID de álbum e ID de mídia de músicas com mídias de tipo 1 ou 2?
```{r}
sql = paste('SELECT name, albumid, mediatypeid FROM tracks'
,
'WHERE mediatypeid IN (1, 2)'
,
'ORDER BY name LIMIT 5')
dbGetQuery(db, sql)
```
# Desafio .2
### (foi retirado a "LIMIT 5")
## Quais são as músicas e identificadores de faixa e álbum produzidas pelo artista que identificador 12?
```{r}
sql = paste('SELECT trackid, name, albumid FROM tracks'
,
'WHERE albumid IN'
,
'(SELECT albumid FROM albums WHERE artistid==12)')
dbGetQuery(db, sql)
```
## Quais são as faixas cujos nomes começam com qualquer caracter seguido de 'ere' e terminam com qualquer expressão?
```{r}
sql = "SELECT trackid, name FROM tracks WHERE name GLOB '?ere*'"
dbGetQuery(db, sql)[1:5,]
```
## Quais são as faixas cujos nomes possuem algum dígito?
```{r}
sql = "SELECT trackid, name FROM tracks WHERE name GLOB '*[0-9]*'"
dbGetQuery(db, sql)[1:5,]
```
## Quantas faixas por disco?
```{r}
sql = 'SELECT albumid, COUNT(trackid) FROM tracks GROUP BY albumid'
dbGetQuery(db, sql)[1:5,]
```
## Quantas faixas por disco para o album 1?
```{r}
sql = paste('SELECT albumid, COUNT(trackid)'
,
'FROM tracks GROUP BY albumid'
,
'HAVING albumid=1')
dbGetQuery(db, sql)
```



